{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 2c3746bf01cf1cda710a","webpack:///./src/index.js","webpack:///./src/core.js","webpack:///./src/emitter.js","webpack:///./src/util.js","webpack:///./src/events.js","webpack:///./src/status.js","webpack:///./src/errors.js","webpack:///./src/filerequest.js","webpack:///./src/collector/dnd.js","webpack:///./src/html5/runtime.js","webpack:///./src/runtime.js","webpack:///./src/html5/transport.js","webpack:///./src/file.js","webpack:///./src/collector/paste.js","webpack:///./src/collector/picker.js"],"names":["Core","require","Events","Status","UploadCore","VERSION","module","exports","Emitter","QueueLimitError","FilterError","DuplicateError","FileExtensionError","FileSizeError","formatSize","parseSize","normalizeAccept","FileRequest","DndCollector","PasteCollector","PickerCollector","REQUEST_OPTIONS","options","autoPending","auto","capcity","queueCapcity","multiple","accept","sizeLimit","fileSizeLimit","pending","Pending","processThreads","stat","Stat","constraints","Constraints","filters","Filters","addConstraint","getTotal","length","addFilter","file","some","item","extensions","indexOf","ext","size","preventDuplicate","getFiles","name","Array","isArray","fitlers","forEach","filter","request","key","hasOwnProperty","requestOptions","console","error","constraint","add","isLimit","emit","QUEUE_ERROR","QUEUE_FILE_FILTERED","setStatus","QUEUED","on","FILE_STATUS_CHANGE","status","CANCELLED","remove","PENDING","setTimeout","QUEUE_UPLOAD_START","QUEUE_STAT_CHANGE","PROCESS","QUEUE_UPLOAD_END","setCore","QUEUE_FILE_ADDED","getStat","flag","picker","dnd","paster","url","setSWF","Set","_set","shift","pop","slice","has","push","i","splice","files","toArray","getStatus","ret","fn","call","every","e","Error","toString","threads","heading","session","always","load","prepare","process","Deferred","event","listener","toLowerCase","_events","that","off","apply","arguments","listeners","emitter","propagationTarget","args","applyEmit","pArgs","unshift","data","HookInvoker","hooks","initialData","context","_data","_error","_aborted","promise","abort","fail","reject","done","resolve","setData","constructor","next","hook","res","then","parseFloat","prefixesSI","base","index","Math","floor","log","min","powedPrecision","pow","round","units","t","g","m","k","exec","u","ACCEPTs","images","title","audios","videos","normalizeExtensions","split","map","accepts","mimeTypes","createOptions","option","match","extend","target","source","isFunction","obj","ArrayFrom","from","arrayLike","Callbacks","firing","memory","fired","firingLength","firingIndex","firingStart","list","_this","stack","once","fire","stopOnFalse","disable","start","unique","empty","disabled","lock","locked","fireWith","func","tuples","state","deferred","fns","newDefer","tuple","returned","progress","notify","pipe","stateString","FILE_UPLOAD_START","FILE_UPLOAD_PREPARING","FILE_UPLOAD_PREPARED","CHUNK_UPLOAD_PREPARING","CHUNK_UPLOAD_COMPLETING","FILE_UPLOAD_PROGRESS","FILE_UPLOAD_END","FILE_UPLOAD_COMPLETING","FILE_UPLOAD_SUCCESS","FILE_UPLOAD_ERROR","FILE_UPLOAD_COMPLETED","FILE_CANCEL","ALL","INITED","PROGRESS","END","SUCCESS","ERROR","StatusName","_Error","message","AbortError","TimeoutError","NetworkError","ChunkResponse","rawResponse","chunkRequest","response","getResponse","getJson","JSON","parse","ChunkRequest","blob","fileRequest","getFile","getName","isMultiChunk","params","getParams","clone","getParam","value","setParam","getUrl","headers","getHeaders","isWithCredentials","getTimeout","FileResponse","getChunkRequest","Params","removeParam","addParam","param","single","encodeURIComponent","join","MIN_CHUNK_SIZE","action","withCredentials","timeout","chunkSize","chunkRetries","chunkEnable","chunkProcessThreads","retries","getChunkSize","getRuntime","canSlice","Runtime","File","MAX_NUM_ONCE","createReader","collector","dataTransfer","responders","items","times","_break","collect","readEntry","entry","isFile","isDirectory","readEntries","entries","l","webkitGetAsEntry","Area","area","areaElement","contains","allowed","Collectors","window","document","addEventListener","runtime","getInstance","started","enter","endTimer","dataTransferReader","total","responder","recieve","move","dropEffect","preventDefault","end","drag","clearTimeout","isLeave","type","drop","getData","ex","core","areas","destroy","removeAllListeners","r","isMultiple","Transport","instance","Html5Runtime","fr","FileReader","timer","onloadend","readyState","DONE","result","readAsDataURL","transport","Blob","prototype","mozSlice","webkitSlice","blobSlice","SparkMD5","chunks","ceil","chunk","spark","ArrayBuffer","loadNext","onload","append","readAsArrayBuffer","uploading","Uploading","getSource","useChunk","isChunkEnable","max","getChunkProcessThreads","slots","getActives","reduce","sum","slot","readChunk","req","createChunkRequest","setHeader","getChunkRetries","loaded","getCore","completion","getBlob","invoke","getTransport","generate","createChunkResponse","Html5Transport","xhr","XMLHttpRequest","timeoutTimer","clean","onerror","upload","onprogress","complete","responseText","statusText","open","header","setRequestHeader","formData","FormData","getBlobName","send","uid","guid","toUpperCase","RE_EXT","RE_IMAGE","guessExt","guessType","Progress","change","percentage","filename","id","test","lastModified","Date","setPropagationTarget","silent","prevStatus","_dataUrlPromise","getAsDataUrl","_md5Promise","md5","_sessionPromise","_session","_flows","flow","createFileRequest","getUploading","createFileResponse","cancel","paste","clipboardData","prevent","addRet","kind","getAsFile","stopPropagation","removeEventListener","createElement","div","html","innerHTML","firstChild","removeChild","Html5TriggerCollection","onFiles","onChange","destroyInput","createInput","input","body","getAccept","setAttribute","appendChild","trigger","click","triggerCollection"],"mappings":"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","file":"uploadcore.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"UploadCore\"] = factory();\n\telse\n\t\troot[\"UploadCore\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2c3746bf01cf1cda710a","const Core = require('./core');\nconst Events = require('./events');\nconst {Status} = require('./status');\n\nCore.Events = Events;\nCore.Status = Status;\nCore.UploadCore = Core;\nCore.VERSION = VERSION;\nCore.Core = Core;\n\nmodule.exports = Core;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const Emitter = require('./emitter');\nconst Events = require('./events');\nconst {Status} = require('./status');\nconst {QueueLimitError, FilterError, DuplicateError, FileExtensionError, FileSizeError} = require('./errors');\nconst {formatSize, parseSize, normalizeAccept} = require('./util');\nconst FileRequest = require('./filerequest');\nconst DndCollector = require('./collector/dnd');\nconst PasteCollector = require('./collector/paste');\nconst PickerCollector = require('./collector/picker');\n\nconst REQUEST_OPTIONS = ['name', 'url', 'params', 'action', 'data', 'headers', 'withCredentials', 'timeout', 'chunkEnable', 'chunkSize', 'chunkRetries', 'chunkProcessThreads'];\n\nclass Core extends Emitter {\n\n    constructor(options = {}) {\n        super();\n\n        this.autoPending = options.autoPending || options.auto;\n        this.capcity = options.capcity || options.queueCapcity || 0;\n        this.multiple = options.multiple == null ? true : options.multiple;\n\n        this.accept = normalizeAccept(options.accept);\n        this.sizeLimit = parseSize(options.sizeLimit || options.fileSizeLimit || 0);\n\n        this.pending = new Pending(options.processThreads);\n        this.stat = new Stat;\n        this.constraints = new Constraints;\n        this.filters = new Filters;\n\n        this.addConstraint(() => {\n            if (this.capcity > 0) {\n                return this.stat.getTotal() >= this.capcity\n            }\n            else {\n                return false;\n            }\n        });\n\n        if (this.accept && this.accept.length > 0) {\n            this.addFilter((file) => {\n                if (!this.accept.some((item) => {\n                    return item.extensions && item.extensions.indexOf(file.ext) > -1\n                }))\n                {\n                    return new FileExtensionError(file, 'extension \"' + file.ext + '\" is not allowed');\n                }\n            });\n        }\n\n        if (this.sizeLimit > 0) {\n            this.addFilter((file) => {\n                if (file.size > this.sizeLimit) {\n                    return new FileSizeError(file, 'filesize:' + formatSize(file.size) + ' is greater than limit:' + formatSize(this.sizeLimit));\n                }\n            });\n        }\n\n        if (options.preventDuplicate) {\n            this.addFilter((file) => {\n                if (this.stat.getFiles().some((item) => item.name === file.name && item.size === file.size)) {\n                    return new DuplicateError(file, 'file \"' + file.name + '\" already in queue');\n                }\n            });\n        }\n\n        if (Array.isArray(options.filters)) {\n            options.fitlers.forEach(filter => this.addFilter(filter));\n        }\n\n        let request = options.request || {};\n        REQUEST_OPTIONS.forEach((key) => {\n            if (options.hasOwnProperty(key)) {\n                request[key] = options[key];\n            }\n        });\n\n        this.requestOptions = request;\n    }\n\n    setOptions(options) {\n        if (typeof options === 'object' && !(options instanceof Array)) {\n            this.autoPending = options.autoPending || options.auto || this.autoPending;\n            this.capcity = options.capcity || options.queueCapcity || this.capcity;\n            this.sizeLimit = parseSize(options.sizeLimit || options.fileSizeLimit || this.sizeLimit);\n            let requestOptions = this.requestOptions\n            REQUEST_OPTIONS.forEach((key) => {\n                if (options.hasOwnProperty(key)) {\n                    requestOptions[key] = options[key];\n                }\n            });\n        }\n        else {\n            console && console.error('setOptions: type error, options should be an object/hashMap');\n        }\n    }\n\n    createFileRequest(file) {\n        return new FileRequest(file, this.requestOptions);\n    }\n\n    isLimit() {\n        return this.constraints.some();\n    }\n\n    addConstraint(constraint) {\n        return this.constraints.add(constraint);\n    }\n\n    addFilter(filter) {\n        return this.filters.add(filter);\n    }\n\n    add(file) {\n        if (this.isLimit()) {\n            this.emit(Events.QUEUE_ERROR, new QueueLimitError);\n            return -1;\n        }\n\n        let error = this.filters.filter(file);\n        if (!error && !this.stat.add(file)) {\n            error = new DuplicateError(file, 'file \"' + file.name + '\" already in queue');\n        }\n\n        if (error) {\n            this.emit(Events.QUEUE_FILE_FILTERED, file, error);\n            this.emit(Events.QUEUE_ERROR, error);\n            return 0;\n        }\n\n        file.setStatus(Status.QUEUED);\n\n        file.on(Events.FILE_STATUS_CHANGE, (status) => {\n            if (status === Status.CANCELLED) {\n                this.stat.remove(file);\n            } else if (status === Status.PENDING) {\n                setTimeout(() => {\n                    if (this.pending.add(file) && this.pending.size() === 1) {\n                        this.emit(Events.QUEUE_UPLOAD_START);\n                    }\n                }, 1);\n            }\n\n            this.emit(Events.QUEUE_STAT_CHANGE, this.stat);\n\n            if (this.stat.getFiles(Status.PROCESS).length < 1) {\n                this.emit(Events.QUEUE_UPLOAD_END);\n            }\n        });\n\n        file.setCore(this);\n\n        this.emit(Events.QUEUE_FILE_ADDED, file);\n\n        this.emit(Events.QUEUE_STAT_CHANGE, this.stat);\n\n        if (this.autoPending) {\n            file.pending();\n        }\n\n        return 1;\n    }\n\n    isMultiple() {\n        return this.multiple;\n    }\n\n    isFull() {\n        return this.capcity > 0 && this.getTotal() >= this.capcity;\n    }\n\n    isEmpty() {\n        return this.getTotal() < 1;\n    }\n\n    getAccept() {\n        return this.accept;\n    }\n\n    getStat() {\n        return this.stat;\n    }\n\n    getTotal() {\n        return this.getStat().getTotal();\n    }\n\n    getFiles(flag) {\n        return this.getStat().getFiles(flag);\n    }\n\n    stat(flag) {\n        return this.getStat().stat(flag);\n    }\n\n    static setSWF(url) {\n        PickerCollector.setSWF(url);\n    }\n\n    getPickerCollector() {\n        if (!this.picker) {\n            this.picker = new PickerCollector(this);\n        }\n        return this.picker;\n    }\n\n    getDndCollector() {\n        if (!this.dnd) {\n            this.dnd = new DndCollector(this);\n        }\n        return this.dnd;\n    }\n\n    getPasteCollector() {\n        if (!this.paster) {\n            this.paster = new PasteCollector(this);\n        }\n        return this.paster;\n    }\n}\n\nmodule.exports = Core;\n\nclass Set {\n    constructor() {\n        this._set = [];\n    }\n\n    /**\n     * \n     *\n     * @returns {Number}\n     */\n    size() {\n        return this._set.length;\n    }\n\n    /**\n     * \n     *\n     * @returns {*}\n     */\n    shift() {\n        return this._set.shift();\n    }\n\n    /**\n     * \n     *\n     * @returns {*}\n     */\n    pop() {\n        return this._set.pop();\n    }\n\n    /**\n     * \n     *\n     * @returns {Array}\n     */\n    toArray() {\n        return this._set.slice(0);\n    }\n\n    /**\n     * \n     *\n     * @param item\n     * @returns {boolean} success if true\n     */\n    add(item) {\n        if (this.has(item)) {\n            return false;\n        }\n        this._set.push(item);\n        return true;\n    }\n\n    /**\n     * \n     *\n     * @param item\n     * @returns {boolean}\n     */\n    has(item) {\n        return this._set.indexOf(item) > -1;\n    }\n\n    /**\n     * \n     *\n     * @returns {boolean} success if true\n     */\n    remove(item) {\n        var i = this._set.indexOf(item);\n        if (i > -1) {\n            this._set.splice(i, 1);\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * \n     */\n    clear() {\n        this._set = [];\n    }\n}\n\nclass Stat {\n    constructor() {\n        this.files = new Set;\n    }\n    add(file) {\n        return this.files.add(file);\n    }\n    remove(file) {\n        this.files.remove(file);\n    }\n    getTotal() {\n        return this.files.size();\n    }\n    getFiles(flag) {\n        var files = this.files.toArray();\n        if (!flag) {\n            return files;\n        }\n        return files.filter((file) => {\n            return !!(file.getStatus() & flag);\n        });\n    }\n    stat(flag) {\n        let ret = {}, files = this.getFiles(flag);\n\n        files.forEach((file) => {\n            let status = file.getStatus();\n            ret[status] = (status in ret) ?  (ret[status] + 1) : 1;\n        });\n\n        ret['sum'] = files.length;\n\n        return ret;\n    }\n}\n\nclass Constraints {\n    constructor() {\n        this.constraints = new Set;\n    }\n\n    add(constraint) {\n        this.constraints.add(constraint);\n        return this;\n    }\n\n    remove(constraint) {\n        this.constraints.remove(constraint);\n        return this;\n    }\n\n    some() {\n        return this.constraints.toArray().some((fn) => fn.call(this));\n    }\n}\n\nclass Filters {\n    constructor() {\n        this.filters = new Set;\n    }\n\n    add(filter) {\n        this.filters.add(filter);\n        return this;\n    }\n\n    remove(filter) {\n        this.filters.remove(filter);\n        return this;\n    }\n\n    filter(file) {\n        let error = null;\n        this.filters.toArray().every((filter) => {\n            let ret;\n            try {\n                ret = filter(file);\n            } catch (e) {\n                ret = e;\n            }\n            if (typeof ret === 'string') {\n                error = new FilterError(file, ret);\n                return false;\n            } else if (ret instanceof Error) {\n                error = ret instanceof FilterError ? ret : new FilterError(file, ret.toString());\n                return false;\n            }\n            return true;\n        });\n        return error;\n    }\n}\n\nclass Pending {\n    constructor(threads) {\n        this.threads = threads || 2;\n        this.heading = new Set;\n        this.pending = new Set;\n    }\n\n    add(file) {\n        if (!this.pending.add(file)) return false;\n\n        file.session().always(() => this.pending.remove(file));\n\n        this.load();\n\n        return true;\n    }\n\n    size() {\n        return this.pending.size() + this.heading.size();\n    }\n\n    process(file) {\n        if (!this.heading.add(file)) return;\n\n        file.session().always(() => {\n            this.heading.remove(file);\n            this.load();\n        });\n    }\n\n    load () {\n        var file;\n        while (this.heading.size() < this.threads && (file = this.pending.shift())) {\n            if (file.prepare()) {\n                this.process(file);\n            }\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core.js","const {Deferred} = require('./util');\n\nclass Emitter {\n\n    on(event, listener) {\n        event = event.toLowerCase();\n        if (!this._events) {\n            this._events = {};\n        }\n\n        if (!this._events[event]) {\n            this._events[event] = [];\n        }\n\n        this._events[event].push(listener);\n\n        return this;\n    }\n\n    once(event, listener) {\n        event = event.toLowerCase();\n\n        let that = this;\n\n        function fn() {\n            that.off(event, fn);\n            listener.apply(this, arguments);\n        }\n\n        fn.listener = listener;\n\n        this.on(event, fn);\n\n        return this;\n    }\n\n    off(event, listener) {\n        event = event.toLowerCase();\n\n        let listeners;\n\n        if (!this._events || !(listeners = this._events[event])) {\n            return this;\n        }\n\n        let i = listeners.length;\n        while (i-- > 0) {\n            if (listeners[i] === listener || listeners[i].listener === listener) {\n                listeners.splice(i, 1);\n                break;\n            }\n        }\n\n        if (listeners.length === 0) {\n            delete this._events[event];\n        }\n\n        return this;\n    }\n\n    removeAllListeners(event) {\n        if (!event) {\n            this._events = {};\n        } else {\n            delete this._events[event.toLowerCase()];\n        }\n\n        return this;\n    }\n\n    setPropagationTarget(emitter) {\n        if (emitter instanceof Emitter) {\n            this.propagationTarget = emitter;\n        }\n    }\n\n    emit(event, ...args) {\n        this.applyEmit(event, args);\n    }\n\n    applyEmit(event, args) {\n        event = event.toLowerCase();\n\n        let listeners;\n\n        if (this._events && (listeners = this._events[event])) {\n            listeners.slice(0).forEach((fn) => {\n                if (listeners.indexOf(fn) !== -1) {\n                    fn.apply(this, args)\n                }\n            });\n        }\n\n        if (this.propagationTarget) {\n            const pArgs = args.slice(0);\n            pArgs.unshift(this);\n            this.propagationTarget.applyEmit(event, pArgs);\n        }\n\n        return this;\n    }\n\n    invoke(event, data) {\n        event = event.toLowerCase();\n\n        let listeners;\n\n        if (!this._events || !(listeners = this._events[event])) {\n            listeners = [];\n        }\n\n        return HookInvoker(listeners.slice(0), data, this);\n    }\n}\n\nmodule.exports = Emitter;\n\nfunction HookInvoker(hooks, initialData, context) {\n    let _data = initialData;\n    let _error = null;\n    let _aborted;\n\n    const i = Deferred();\n    const ret = i.promise();\n\n    ret.abort = () => {\n        _aborted = true;\n    };\n\n    const fail = (e) => {\n        if (_aborted) return;\n        if (e) {\n            _error = e instanceof Error ? e : new Error(e);\n        }\n        i.reject(_error || new Error('Unknown'));\n    };\n\n    const done = () => {\n        if (_aborted) return;\n        if (_error != null) {\n            fail();\n        } else {\n            i.resolve(_data);\n        }\n    };\n\n    const setData = (data) => {\n        if (data != null && (_data == null || data.constructor === _data.constructor)) {\n            _data = data;\n        }\n    };\n\n    const next = (data) => {\n        if (_aborted) return;\n\n        if (data instanceof Error) {\n            _error = data;\n        }\n\n        if (_error != null) {\n            return fail();\n        }\n\n        setData(data);\n\n        const hook = hooks.shift();\n        if (!hook) {\n            return done();\n        }\n        let res;\n        try {\n            res = hook.call(context, _data);\n        } catch (e) {\n            return fail(e);\n        }\n\n        if (res && res.then) {\n            res.then(next, fail);\n        } else {\n            next(res);\n        }\n    };\n\n    setTimeout(next, 1);\n\n    return ret;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/emitter.js","exports.formatSize = function (size) {\n    size = parseFloat(size);\n    const prefixesSI = ['', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'],\n        base = 1024;\n    let index = size ? Math.floor(Math.log(size) / Math.log(base)) : 0;\n    index = Math.min(index, prefixesSI.length - 1);\n    let powedPrecision = Math.pow(10, index < 2 ? 0 : (index > 2 ? 2 : 1));\n    size = size / Math.pow(base, index);\n    size = Math.round(size * powedPrecision) / powedPrecision;\n    return size + prefixesSI[index] + 'B';\n};\n\nexports.parseSize = function (size) {\n    if (typeof size !== 'string') {\n        return size;\n    }\n\n    const units = {\n        t: 1099511627776,\n        g: 1073741824,\n        m: 1048576,\n        k: 1024\n    };\n\n    size = /^([0-9\\.]+)([tgmk]?)b?$/i.exec(size);\n    const u = size[2];\n    size = +size[1];\n\n    if (units.hasOwnProperty(u)) {\n        size *= units[u];\n    }\n    return size;\n};\n\nconst ACCEPTs = {\n    images: {\n        title: 'Images',\n        extensions: ['jpg', 'jpeg', 'gif', 'png', 'bmp', 'svg', 'tiff', 'tif', 'ico', 'jpe', 'svgz', 'pct', 'psp', 'ai', 'psd', 'raw', 'webp']\n    },\n\n    audios: {\n        title: 'Audios',\n        extensions: ['aac', 'aif', 'flac', 'iff', 'm4a', 'm4b', 'mid', 'midi', 'mp3', 'mpa', 'mpc', 'oga', 'ogg', 'ra', 'ram', 'snd', 'wav', 'wma']\n    },\n\n    videos: {\n        title: 'Videos',\n        extensions: ['avi', 'divx', 'flv', 'm4v', 'mkv', 'mov', 'mp4', 'mpeg', 'mpg', 'ogm', 'ogv', 'ogx', 'rm', 'rmvb', 'smil', 'webm', 'wmv', 'xvid']\n    }\n};\n\nfunction normalizeExtensions(extensions) {\n    if (typeof extensions !== 'string') {\n        return '';\n    }\n\n    return extensions.toLowerCase().split(/ *[ ,;|+] */).map((ext) => {\n        let m = /^\\*?\\.?(\\w+)$/.exec(ext);\n        return m ? m[1] : null;\n    }).filter(ext => ext !== null);\n}\n\nfunction normalizeAccept(accepts) {\n    if (!accepts) return null;\n\n    if (!Array.isArray(accepts)) {\n        accepts = [accepts];\n    }\n\n    return accepts.map((accept) => {\n        if (typeof accept === 'string' && (accept = accept.toLowerCase()) && ACCEPTs.hasOwnProperty(accept)) {\n            return ACCEPTs[accept];\n        } else {\n            let extensions = normalizeExtensions(accept.extensions || accept);\n\n            return extensions.length ? {\n                title: accept.title || '',\n                extensions: extensions,\n                mimeTypes: accept.mimeTypes || ''\n            } : null;\n        }\n    }).filter(accept => accept !== null);\n}\n\nexports.normalizeAccept = normalizeAccept;\n\n    function createOptions(option) {\n    const options = {};\n    (option.match(/\\S+/g) || []).forEach((flag) => {\n        options[flag] = true;\n    });\n    return options;\n}\n\nfunction extend(target, source) {\n    for (let key in source) {\n        target[key] = source[key];\n    }\n    return target;\n}\n\nexports.extend = extend;\n\nfunction isFunction(obj) {\n    return typeof obj === 'function';\n}\n\nconst ArrayFrom = Array.from || function (arrayLike) {\n    return [].slice.call(arrayLike);\n};\n\nfunction Callbacks(options) {\n    options = typeof options === \"string\"\n        ? createOptions(options)\n        : extend({}, options);\n\n    let firing, memory, fired, firingLength, firingIndex, firingStart,\n        list = [], _this,\n        stack = !options.once && [],\n        fire = function (data) {\n            memory = options.memory && data;\n            fired = true;\n            firingIndex = firingStart || 0;\n            firingStart = 0;\n            firingLength = list.length;\n            firing = true;\n            for (; list && firingIndex < firingLength; firingIndex++) {\n                if (list[firingIndex].apply(data[0], data[1]) === false && options.stopOnFalse) {\n                    memory = false; // To prevent further calls using add\n                    break;\n                }\n            }\n            firing = false;\n            if (list) {\n                if (stack) {\n                    if (stack.length) {\n                        fire(stack.shift());\n                    }\n                } else if (memory) {\n                    list = [];\n                } else {\n                    _this.disable();\n                }\n            }\n        };\n\n    _this = {\n        add() {\n            if (list) {\n                let start = list.length;\n\n                (function add(args) {\n                    args.forEach((fn) => {\n                        if (isFunction(fn)) {\n                            if (!options.unique || !_this.has(fn)) {\n                                list.push(fn);\n                            }\n                        } else if (Array.isArray(fn)) {\n                            add(fn);\n                        }\n                    });\n                })(ArrayFrom(arguments));\n\n                if (firing) {\n                    firingLength = list.length;\n                } else if (memory) {\n                    firingStart = start;\n                    fire(memory);\n                }\n            }\n            return this;\n        },\n\n        remove() {\n            if (list) {\n                ArrayFrom(arguments).forEach((fn) => {\n                    let i = list.length;\n                    while (--i >= 0) {\n                        if (list[i] !== fn) continue;\n\n                        list.splice(i, 1);\n\n                        if (firing) {\n                            if (i <= firingLength) {\n                                firingLength--;\n                            }\n                            if (i <= firingIndex) {\n                                firingIndex--;\n                            }\n                        }\n                    }\n                });\n            }\n            return this;\n        },\n\n        has(fn) {\n            return fn ? list.indexOf(fn) > -1 : !!(list && list.length);\n        },\n\n        empty() {\n            list = [];\n            firingLength = 0;\n            return this;\n        },\n\n        disable() {\n            list = stack = memory = null;\n            return this;\n        },\n\n        disabled() {\n            return !list;\n        },\n\n        lock() {\n            stack = null;\n            if (!memory) {\n                _this.disable();\n            }\n            return this;\n        },\n\n        locked() {\n            return !stack;\n        },\n\n        fireWith(context, args) {\n            if (list && (!fired || stack)) {\n                args = args || [];\n                args = [context, args.slice ? args.slice() : args];\n                if (firing) {\n                    stack.push(args);\n                } else {\n                    fire(args);\n                }\n            }\n            return this;\n        },\n\n        fire() {\n            _this.fireWith(this, arguments);\n            return this;\n        },\n\n        fired() {\n            return !!fired;\n        }\n    };\n\n    return _this;\n};\n\nfunction Deferred(func) {\n    let tuples = [\n        [\"resolve\", \"done\", Callbacks(\"once memory\"), \"resolved\"],\n        [\"reject\", \"fail\", Callbacks(\"once memory\"), \"rejected\"],\n        [\"notify\", \"progress\", Callbacks(\"memory\")]\n    ],\n    state = \"pending\",\n    promise = {\n        state() {\n            return state;\n        },\n\n        always() {\n            const args = ArrayFrom(arguments);\n            deferred.done(args).fail(args);\n            return this;\n        },\n\n        then(/* fnDone, fnFail, fnProgress */) {\n            let fns = arguments;\n            return Deferred((newDefer) => {\n                tuples.forEach((tuple, i) => {\n                    let fn = isFunction(fns[i]) && fns[i];\n                    deferred[tuple[1]](function () {\n                        const returned = fn && fn.apply(this, arguments);\n                        if (returned && isFunction(returned.promise)) {\n                            returned.promise()\n                                .done(newDefer.resolve)\n                                .fail(newDefer.reject)\n                                .progress(newDefer.notify);\n                        } else {\n                            newDefer[tuple[0] + \"With\"](\n                                this === promise ? newDefer.promise() : this,\n                                fn ? [returned] : arguments\n                            );\n                        }\n                    });\n                });\n                fns = null;\n            }).promise();\n        },\n\n        promise(obj) {\n            return obj != null ? extend(obj, promise) : promise;\n        }\n    }, deferred = {};\n\n    promise.pipe = promise.then;\n\n    tuples.forEach((tuple, i) => {\n        let list = tuple[2],\n            stateString = tuple[3];\n\n        promise[tuple[1]] = list.add;\n\n        if (stateString) {\n            list.add(\n                () => { state = stateString; },\n                tuples[i^1][2].disable,\n                tuples[2][2].lock\n            );\n        }\n\n        deferred[tuple[0]] = function () {\n            deferred[tuple[0] + \"With\"](this === deferred ? promise : this, arguments);\n            return this;\n        };\n\n        deferred[tuple[0] + \"With\"] = list.fireWith;\n    });\n\n    promise.promise(deferred);\n\n    if (func) {\n        func.call(deferred, deferred);\n    }\n\n    return deferred;\n}\n\nexports.Deferred = Deferred;\n\n\n// WEBPACK FOOTER //\n// ./src/util.js","module.exports = {\n    QUEUE_UPLOAD_START: 'queueuploadstart', // \n    QUEUE_UPLOAD_END: 'queueuploadend', // \n    QUEUE_FILE_ADDED: 'queuefileadded', // \n    QUEUE_FILE_FILTERED: 'queuefilefiltered', // \n    QUEUE_ERROR: 'queueerror', // \n    QUEUE_STAT_CHANGE: 'statchange', // \n\n    FILE_UPLOAD_START: 'fileuploadstart', // \n    FILE_UPLOAD_PREPARING: 'fileuploadpreparing', // \n    FILE_UPLOAD_PREPARED: 'fileuploadprepared', // \n    CHUNK_UPLOAD_PREPARING: 'chunkuploadpreparing', // \n    CHUNK_UPLOAD_COMPLETING: 'chunkuploadcompleting', // \n    FILE_UPLOAD_PROGRESS: 'fileuploadprogress', // \n    FILE_UPLOAD_END: 'fileuploadend', // \n    FILE_UPLOAD_COMPLETING: 'fileuploadcompleting', // \n    FILE_UPLOAD_SUCCESS: 'fileuploadsuccess', // \n    FILE_UPLOAD_ERROR: 'fileuploaderror', // \n    FILE_UPLOAD_COMPLETED: 'fileuploadcompleted', // \n\n    FILE_CANCEL: 'filecancel', // \n    FILE_STATUS_CHANGE: 'filestatuschange' // \n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/events.js","exports.Status = {\n    ALL: 255, // \n\n    PROCESS: 31, // INITED -> END\n    INITED: 1, // \n    QUEUED: 2, // \n    PENDING: 4, // \n    PROGRESS: 8, // \n    END: 16, // , \n\n    SUCCESS: 32,  // \n    ERROR: 64, // \n    CANCELLED: 128  //   queued , \n};\n\nexports.StatusName = {\n    1: 'inited',\n    2: 'queued',\n    4: 'pending',\n    8: 'progress',\n    16: 'end',\n    32: 'success',\n    64: 'error',\n    128: 'cancelled'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/status.js","class _Error extends Error {\n    constructor(message) {\n        super(message);\n        this.message = message;\n    }\n}\n\nclass AbortError extends _Error {\n    constructor(message) {\n        super(message);\n        this.name = 'AbortError';\n    }\n}\n\nclass TimeoutError extends _Error {\n    constructor(message) {\n        super(message);\n        this.name = 'TimeoutError';\n    }\n}\n\nclass NetworkError extends _Error {\n    constructor(status, message) {\n        super(message);\n        this.name = 'NetworkError';\n        this.status = status;\n    }\n}\n\nclass QueueLimitError extends _Error {\n    constructor() {\n        super('queue limit');\n        this.name = 'QueueLimitError';\n    }\n}\n\nclass FilterError extends _Error {\n    constructor(file, message) {\n        super(message);\n        this.name = 'FilterError';\n        this.file = file;\n    }\n}\n\nclass DuplicateError extends FilterError {\n    constructor(file, message) {\n        super(file, message);\n        this.name = 'DuplicateError';\n    }\n}\n\nclass FileExtensionError extends FilterError {\n    constructor(file, message) {\n        super(file, message);\n        this.name = 'FileExtensionError';\n    }\n}\n\nclass FileSizeError extends FilterError {\n    constructor(file, message) {\n        super(file, message);\n        this.name = 'FileSizeError';\n    }\n}\n\n\nmodule.exports = {AbortError, TimeoutError, NetworkError,\n    QueueLimitError, FilterError, DuplicateError, FileExtensionError, FileSizeError};\n\n\n\n// WEBPACK FOOTER //\n// ./src/errors.js","const {parseSize} = require('./util');\n\nclass ChunkResponse {\n    /**\n     * @param {string|null} rawResponse\n     * @param {ChunkRequest} chunkRequest\n     */\n    constructor(rawResponse, chunkRequest) {\n        this.rawResponse = rawResponse;\n        this.chunkRequest = chunkRequest;\n    }\n\n    getChunkRequest() {\n        return this.chunkRequest;\n    }\n\n    getRawResponse() {\n        return this.rawResponse;\n    }\n\n    getResponse() {\n        return this.response || this.rawResponse;\n    }\n\n    getJson() {\n        const response = this.getResponse();\n        if (response == null) {\n            return null;\n        }\n        if (typeof response.getJson === 'function') {\n            return response.getJson();\n        }\n        if (typeof response === 'string') {\n            return response === '' ? null : JSON.parse(response);\n        }\n        return response;\n    }\n\n    setResponse(response) {\n        this.response = response;\n        return this;\n    }\n}\n\nclass ChunkRequest {\n    /**\n     *\n     * @param {int} index\n     * @param {Blob} blob\n     * @param {FileRequest} fileRequest\n     */\n    constructor(index, blob, fileRequest) {\n        this.index = index || 0;\n        this.fileRequest = fileRequest;\n        this.blob = blob || fileRequest.getFile().source;\n    }\n\n    getName() {\n        return this.fileRequest.getName();\n    }\n\n    getFile() {\n        return this.fileRequest.getFile();\n    }\n\n    getBlob() {\n        return this.blob;\n    }\n\n    getBlobName() {\n        return this.isMultiChunk() ? (this.blob.name || 'blob') : this.getFile().name;\n    }\n\n    getIndex() {\n        return this.index;\n    }\n\n    isMultiChunk() {\n        return this.getFile().source !== this.blob;\n    }\n\n    getParams() {\n        if (!this.params) {\n            this.params = this.fileRequest.getParams().clone();\n        }\n        return this.params;\n    }\n\n    getParam(name) {\n        return this.getParams().getParam(name);\n    }\n\n    setParam(name, value) {\n        this.getParams().setParam(name, value);\n\n        return this;\n    }\n\n    getFileRequest() {\n        return this.fileRequest;\n    }\n\n    getUrl() {\n        return this.url || this.fileRequest.getUrl();\n    }\n\n    setUrl(url) {\n        this.url = url;\n        return this;\n    }\n\n    getHeaders() {\n        if (!this.headers) {\n            this.headers = this.fileRequest.getHeaders().slice(0);\n        }\n        return this.headers;\n    }\n\n    setHeader(name, value) {\n        var headers = this.getHeaders();\n        headers.push({name: name, value: value});\n        return this;\n    }\n\n    isWithCredentials() {\n        return this.fileRequest.isWithCredentials();\n    }\n\n    getTimeout() {\n        return this.fileRequest.getTimeout();\n    }\n\n    createChunkResponse(response) {\n        return new ChunkResponse(response, this);\n    }\n}\n\nclass FileResponse {\n    /**\n     * @param {ChunkResponse|Object|string} rawResponse\n     * @param {FileRequest} fileRequest\n     */\n    constructor(rawResponse, fileRequest) {\n        this.rawResponse = rawResponse;\n        this.fileRequest = fileRequest;\n    }\n\n    isFromMultiChunkResponse() {\n        if (this.rawResponse instanceof ChunkResponse) {\n            return this.rawResponse.getChunkRequest().isMultiChunk();\n        }\n        return false;\n    }\n\n    getFileRequest() {\n        return this.fileRequest;\n    }\n\n    getRawResponse() {\n        return this.rawResponse;\n    }\n\n    getResponse() {\n        if (this.response != null) {\n            return this.response;\n        }\n        if (this.rawResponse instanceof ChunkResponse) {\n            return this.rawResponse.getResponse();\n        } else {\n            return this.rawResponse;\n        }\n    }\n\n    getJson() {\n        const response = this.getResponse();\n        if (response == null) {\n            return null;\n        }\n        if (typeof response.getJson === 'function') {\n            return response.getJson();\n        }\n        if (typeof response === 'string') {\n            return response === '' ? null : JSON.parse(response);\n        }\n        return response;\n    }\n\n    setResponse(response) {\n        this.response = response;\n        return this;\n    }\n}\n\nclass Params {\n    constructor(params) {\n        if (Array.isArray(params)) {\n            this.params = params.slice(0);\n        } else if (typeof params === 'object') {\n            this.params = [];\n            for (let name in params) {\n                if (params.hasOwnProperty(name)) {\n                    this.params.push({name, value: params[name]});\n                }\n            }\n        } else {\n            this.params = [];\n        }\n    }\n\n    setParam(name, value) {\n        this.removeParam(name);\n        this.addParam(name, value);\n    }\n\n    addParam(name, value) {\n        this.params.push({name, value});\n    }\n\n    removeParam(name) {\n        this.params = this.params.filter((param) => param.name !== name);\n    }\n\n    getParam(name, single) {\n        let ret = this.params.filter((param) => param.name === name)\n            .map((param) => param.value);\n\n        if (single) {\n            return ret.shift();\n        }\n\n        return ret;\n    }\n\n    clone() {\n        return new Params(this.params);\n    }\n\n    toArray() {\n        return this.params;\n    }\n\n    toString() {\n        const params = this.params.map((param) => {\n            return encodeURIComponent(param.name) + '=' + (param.value == null ? '' : encodeURIComponent(param.value));\n        });\n\n        return params.join('&'); //.replace( /%20/g, '+');\n    }\n}\n\nconst MIN_CHUNK_SIZE = 256 * 1024; // 256K\n\nclass FileRequest {\n    constructor(file, options = {}) {\n        this.file = file;\n        this.name = options.name || 'file';\n        this.url = options.url || options.action;\n        this.params = new Params(options.params || options.data);\n        this.headers = options.headers || [];\n        this.withCredentials = options.withCredentials;\n        this.timeout = options.timeout || 0;\n        this.chunkSize = options.chunkSize || 0;\n        this.chunkRetries = options.chunkRetries || 0;\n        this.chunkEnable = options.chunkEnable || false;\n        this.chunkProcessThreads = options.chunkProcessThreads || 2;\n    }\n\n    getFile() {\n        return this.file;\n    }\n\n    getUrl() {\n        return this.url || '';\n    }\n\n    getName() {\n        return this.name;\n    }\n\n    setName(name) {\n        this.name = name;\n        return this;\n    }\n\n    setUrl(url) {\n        this.url = url;\n        return this;\n    }\n\n    getParams() {\n        return this.params;\n    }\n\n    getParam(name) {\n        return this.getParams().getParam(name);\n    }\n\n    setParam(name, value) {\n        this.params.setParam(name, value);\n        return this;\n    }\n\n    getHeaders() {\n        return this.headers;\n    }\n\n    setHeader(name, value) {\n        this.headers.push({name: name, value: value});\n    }\n\n    isWithCredentials() {\n        return this.withCredentials;\n    }\n\n    setWithCredentials(flag) {\n        this.withCredentials = flag;\n        return this;\n    }\n\n    getTimeout() {\n        return this.timeout;\n    }\n\n    setTimeout(timeout) {\n        this.timeout = timeout;\n        return this;\n    }\n\n    getChunkSize() {\n        return parseSize(this.chunkSize);\n    }\n\n    setChunkSize(chunkSize) {\n        this.chunkSize = chunkSize;\n        return this;\n    }\n\n    getChunkRetries() {\n        return this.chunkRetries;\n    }\n\n    setChunkRetries(retries) {\n        this.chunkRetries = retries;\n        return 0;\n    }\n\n    isChunkEnable() {\n        const chunkSize = this.getChunkSize();\n        return this.chunkEnable && chunkSize > MIN_CHUNK_SIZE\n            && this.file.getRuntime().canSlice() && this.file.size > chunkSize;\n    }\n\n    setChunkEnable(flag) {\n        this.chunkEnable = flag;\n        return this;\n    }\n\n    getChunkProcessThreads() {\n        return this.chunkProcessThreads;\n    }\n\n    setChunkProcessThreads(threads) {\n        this.chunkProcessThreads = threads;\n        return this;\n    }\n\n    createChunkRequest(index, blob) {\n        return new ChunkRequest(index, blob, this);\n    }\n\n    createFileResponse(response) {\n        return new FileResponse(response, this);\n    }\n}\n\nmodule.exports = FileRequest;\n\n\n// WEBPACK FOOTER //\n// ./src/filerequest.js","const Emitter = require('../emitter');\nconst Runtime = require('../html5/runtime');\nconst File = require('../file');\n\nconst MAX_NUM_ONCE = 100;\n\nfunction createReader(collector) {\n    return (dataTransfer, responders) => {\n        const items = dataTransfer.items,\n            files = dataTransfer.files;\n        let item, times = MAX_NUM_ONCE;\n        let _break = false;\n\n        function collect(file) {\n            if (--times < 0 || !collector(file, responders)) {\n                _break = true;\n                return false;\n            }\n            return true;\n        }\n\n        function readEntry(entry) {\n            if (_break) return;\n            if (entry.isFile) {\n                entry.file((file) => {\n                    if (!_break) {\n                        collect(file);\n                    }\n                });\n            } else if (entry.isDirectory) {\n                entry.createReader().readEntries((entries) => {\n                    if (_break) return;\n                    for (let i = 0, l = entries.length; i < l; i++) {\n                        if (_break) break;\n                        readEntry(entries[i]);\n                    }\n                });\n            }\n        }\n\n        for (let i = 0, l = files.length; i < l; i++) {\n            if (_break) break;\n            item = items && items[i];\n\n            let entry = item && item.webkitGetAsEntry && item.webkitGetAsEntry();\n\n            if (entry && entry.isDirectory) {\n                readEntry(entry);\n            } else {\n                if (!collect(files[i])) {\n                    break;\n                }\n            }\n        }\n    }\n}\n\nclass Area extends Emitter {\n    constructor(area) {\n        super();\n\n        this.areaElement = area;\n    }\n\n    contains(target) {\n        return this.areaElement.contains(target);\n    }\n\n    start(e, allowed) {\n        this.emit('start', e, allowed);\n    }\n\n    response(e, allowed) {\n        allowed = allowed && this.contains(e.target);\n        this.emit('response', e, allowed);\n        return allowed;\n    }\n\n    end(e) {\n        this.emit('end', e);\n    }\n}\n\nconst Collectors = [];\n\nfunction prepare() {\n    if (!('DataTransfer' in window) || !('FileList' in window) || !document.addEventListener) {\n        return;\n    }\n\n    const runtime = Runtime.getInstance();\n\n    let started = 0, enter = 0, endTimer;\n    const dataTransferReader = createReader((file, responders) => {\n        if (!responders || responders.length < 1) {\n            return false;\n        }\n        file = new File(runtime, file);\n        let total = responders.length;\n        return responders.some((responder) => {\n            const ret = responder.recieve(file);\n            if (ret > 0) {\n                return true;\n            }\n            if (ret < 0) {\n                total -= 1;\n            }\n            return false;\n        }) || total > 0;\n    });\n\n    const start = (e) => {\n        started = 1;\n        Collectors.forEach((responder) => responder.start(e));\n    };\n\n    const move = (e) => {\n        const has = Collectors.filter(responder => responder.response(e)).length > 0;\n\n        const dataTransfer = e.dataTransfer;\n\n        if (dataTransfer) {\n            dataTransfer.dropEffect = has ? 'copy' : 'none';\n        }\n        e.preventDefault();\n    };\n\n    const end = (e) => {\n        started = 0;\n        enter = 0;\n        Collectors.forEach((responder) => responder.end(e));\n    };\n\n    const drag = (e) => {\n        clearTimeout(endTimer);\n        let isLeave = e.type === 'dragleave';\n        if (!isLeave && !started) {\n            start(e);\n        }\n        move(e);\n        if (isLeave) {\n            endTimer = setTimeout(() => end(e), 100);\n        }\n    };\n    const drop = (e) => {\n        e.preventDefault();\n\n        clearTimeout(endTimer);\n        end(e);\n\n        const responders = Collectors.filter((responder) => responder.contains(e.target));\n\n        if (responders.length < 1) {\n            return;\n        }\n\n        let dataTransfer = e.dataTransfer;\n\n        try {\n            if (dataTransfer.getData('text/html')) {\n                return;\n            }\n        } catch (ex) {}\n\n        dataTransferReader(dataTransfer, responders);\n    };\n\n    document.addEventListener('dragenter', drag, false);\n    document.addEventListener('dragover', drag, false);\n    document.addEventListener('dragleave', drag, false);\n    document.addEventListener('drop', drop, false);\n}\n\nclass DndCollector {\n\n    constructor(core) {\n        if (Collectors.length < 1) {\n            prepare();\n        }\n        Collectors.push(this);\n\n        this.core = core;\n        this.areas = [];\n    }\n\n    addArea(area) {\n        area = new Area(area);\n        this.areas.push(area);\n        area.destroy = () => {\n            area.removeAllListeners();\n            let i = this.areas.indexOf(area);\n            if (i > -1) {\n                this.areas.splice(i, 1);\n            }\n        };\n\n        return area;\n    }\n\n    contains(target) {\n        return this.areas.some((area) => area.contains(target));\n    }\n\n    start(e) {\n        this.areas.forEach((area) => area.start(e));\n    }\n\n    response(e) {\n        return this.areas.map((area) => area.response(e)).some(r => r !== false);\n    }\n\n    recieve(file) {\n        const ret = this.core.add(file);\n        if (ret > 0 && !this.core.isMultiple()) {\n            return -1;\n        } else {\n            return ret;\n        }\n    }\n\n    end(e) {\n        this.areas.forEach((area) => area.end(e));\n    }\n}\n\nmodule.exports = DndCollector;\n\n\n// WEBPACK FOOTER //\n// ./src/collector/dnd.js","const Runtime = require('../runtime');\nconst {Deferred} = require('../util');\nconst Transport = require('./transport');\n\nlet instance;\n\nclass Html5Runtime extends Runtime {\n    static getInstance() {\n        if (!instance) {\n            instance = new Html5Runtime;\n        }\n        return instance;\n    }\n\n    getAsDataUrl(blob, timeout) {\n        let i = Deferred(),\n            fr = new FileReader, timer;\n\n        fr.onloadend = () => {\n            if (fr.readyState == FileReader.DONE) {\n                i.resolve(fr.result);\n            } else {\n                i.reject();\n            }\n            clearTimeout(timer);\n            fr.onloadend = null;\n        };\n        fr.readAsDataURL(blob);\n\n        let abort = () => {\n            fr && fr.abort();\n            fr = null;\n        };\n        if (timeout) {\n            timer = setTimeout(abort, timeout);\n        }\n\n        let ret = i.promise();\n        ret.abort = abort;\n\n        return ret;\n    }\n\n    getTransport() {\n        if (!this.transport) {\n            this.transport = new Transport(this);\n        }\n        return this.transport;\n    }\n\n    canSlice() {\n        return !!(Blob.prototype.slice || Blob.prototype.mozSlice || Blob.prototype.webkitSlice);\n    }\n\n    slice(blob, start, end) {\n        let blobSlice = blob.slice || blob.mozSlice || blob.webkitSlice;\n\n        return blobSlice.call(blob, start, end);\n    }\n\n    md5(blob) {\n        const i = Deferred();\n\n        if (!window.SparkMD5) {\n            i.reject();\n            return i.promise();\n        }\n\n        let chunkSize = 2 * 1024 * 1024,\n            chunks = Math.ceil(blob.size / chunkSize),\n            chunk = 0,\n            spark = new SparkMD5.ArrayBuffer(),\n            blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice;\n\n        let fr = new FileReader;\n\n        var loadNext = () => {\n            if (!fr) return;\n            let start, end;\n\n            start = chunk * chunkSize;\n            end = Math.min(start + chunkSize, blob.size);\n\n            fr.onload = () => {\n                spark && spark.append(fr.result);\n            };\n\n            fr.onloadend = () => {\n                if (!fr) return;\n                if (fr.readyState == FileReader.DONE) {\n                    if (++chunk < chunks) {\n                        setTimeout(loadNext, 1);\n                    } else {\n                        setTimeout(() => {\n                            spark && i.resolve(spark.end());\n                            loadNext = blob = spark = null;\n                        }, 50);\n                    }\n                } else {\n                    i.reject();\n                }\n                fr.onloadend = fr.onload = null;\n            };\n\n            fr.readAsArrayBuffer(blobSlice.call(blob, start, end));\n        };\n\n        loadNext();\n\n        let ret = i.promise();\n        ret.abort = function () {\n            fr && fr.abort();\n            spark = null;\n            fr = null;\n        };\n\n        return ret;\n    }\n}\n\nmodule.exports = Html5Runtime;\n\n\n// WEBPACK FOOTER //\n// ./src/html5/runtime.js","const Emitter = require('./emitter');\nconst Events = require('./events');\nconst {Deferred} = require('./util');\nconst {NetworkError} = require('./errors');\n\nclass Runtime extends Emitter {\n    md5(blob) {\n        var i = Deferred();\n        i.reject();\n        return i.promise();\n    }\n    getAsDataUrl(file, timeout) {\n        var i = Deferred();\n        i.reject();\n        return i.promise();\n    }\n    getTransport() {\n        return null;\n    }\n    getUploading() {\n        if (!this.uploading) {\n            this.uploading = new Uploading(this);\n        }\n        return this.uploading;\n    }\n    canSlice() {\n        return false;\n    }\n    slice(blob) {\n        throw new Error('this runtime current not support slice');\n    }\n\n    cancel(blob) {\n\n    }\n}\n\nmodule.exports = Runtime;\n\nclass Uploading {\n    constructor(runtime) {\n        this.runtime = runtime;\n    }\n\n    /**\n     * @param {FileRequest} request\n     * @returns {*}\n     */\n    generate(request) {\n        const i = Deferred(),\n            file = request.getFile(),\n            runtime = this.runtime;\n\n        let source = file.getSource(), size = file.size,\n            chunkSize = request.getChunkSize(),\n            useChunk = request.isChunkEnable(),\n            threads = Math.max(request.getChunkProcessThreads(), 1),\n            start = 0, end = 0, slots = [];\n\n        const getActives = () => {\n            return slots.reduce((sum, slot) => sum + (slot.state() === 'pending' ? 1 : 0), 0);\n        };\n\n        const readChunk = () => {\n            let slot, req, blob;\n            while (end < size && getActives() < threads) {\n                start = end;\n                end = Math.min(end + chunkSize, size);\n                blob = runtime.slice(source, start, end);\n                req = request.createChunkRequest(slots.length, blob);\n                req.setHeader('Content-Range', 'bytes ' + start + '-' + (end - 1) + '/' + size);\n                slot = this.slot(req, request.getChunkRetries());\n                slot.progress(progress).done(done).fail(fail);\n                slots.push(slot);\n            }\n        };\n\n        const progress = () => {\n            let total = size - end, loaded = 0;\n            slots.forEach((slot) => {\n                total += slot.total;\n                loaded += slot.loaded;\n            });\n            i.notify({total, loaded});\n        };\n\n        const done = (res) => {\n            useChunk && readChunk();\n\n            if (end >= size && slots.every((slot) => slot.state() === 'resolved')) {\n                i.resolve(res);\n            }\n        };\n\n        const abort = () => {\n            slots.forEach((slot) => slot.abort());\n        };\n\n        const fail = (error) => {\n            i.reject(error);\n            abort();\n        };\n\n        if (useChunk) {\n            readChunk();\n        } else {\n            end = size;\n            let slot = this.slot(request.createChunkRequest(), 0);\n            slot.progress(progress).done(done).fail(fail);\n            slots.push(slot);\n        }\n\n        let ret = i.promise();\n        ret.abort = abort;\n\n        return ret;\n    }\n\n    slot(request, retries) {\n        let i = Deferred(),\n            runtime = this.runtime,\n            core = request.getFile().getCore();\n\n        let ret = i.promise();\n\n        const progress = (e) => {\n            if (e.total) {\n                ret.total = e.total;\n            }\n            if (e.loaded) {\n                ret.loaded = e.loaded;\n            }\n            i.notify(e);\n        };\n\n        const process = () => {\n            var prepare, transport, completion;\n            ret.abort = function () {\n                prepare && prepare.abort();\n                transport && transport.abort();\n                completion && completion.abort();\n            };\n            ret.total = request.getBlob().size;\n            ret.loaded = 0;\n\n            prepare = core.invoke(Events.CHUNK_UPLOAD_PREPARING, request);\n\n            prepare.then((request) => {\n                transport = runtime.getTransport().generate(request);\n                transport.progress(progress);\n                return transport;\n            }).then((response) => {\n                completion = core.invoke(Events.CHUNK_UPLOAD_COMPLETING, request.createChunkResponse(response));\n                return completion;\n            }).done(i.resolve).fail(error);\n        };\n\n        const error = (e) => {\n            if (e instanceof NetworkError && retries-- > 0) {\n                // retry\n                setTimeout(process, 500);\n            } else {\n                i.reject(e);\n            }\n            ret.abort();\n        };\n\n        process();\n\n        return ret;\n    }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/runtime.js","const {Deferred} = require('../util');\nconst {TimeoutError, AbortError, NetworkError} = require('../errors');\n\nclass Html5Transport {\n    /**\n     * @param {ChunkRequest} request\n     * @returns {*}\n     */\n    generate(request) {\n        const i = Deferred();\n        const xhr = new XMLHttpRequest;\n\n        let timeoutTimer;\n\n        const clean = () => {\n            xhr.onload = xhr.onerror = null;\n            if (xhr.upload) {\n                xhr.upload.onprogress = null;\n            }\n            if (timeoutTimer) {\n                clearTimeout(timeoutTimer);\n            }\n        };\n\n        const abort = () => {\n            clean();\n            try {\n                xhr.abort();\n            } catch (e) {}\n        };\n\n        const complete = (e) => {\n            clean();\n            if (!xhr.status && e.type === 'error') {\n                return i.reject(new AbortError(e.message));\n            }\n            if (xhr.status === 0 || xhr.status === 304 || xhr.status >= 200 && xhr.status < 300) {\n                return i.resolve(xhr.responseText);\n            }\n            return i.reject(new NetworkError(xhr.status, xhr.statusText));\n        };\n\n        if (xhr.upload) {\n            xhr.upload.onprogress = (e) => i.notify(e);\n        }\n        xhr.onerror = complete;\n        xhr.onload = complete;\n\n        // Timeout\n        const timeout = request.getTimeout();\n        if (timeout > 0) {\n            timeoutTimer = setTimeout(() => {\n                abort();\n                i.reject(new TimeoutError('timeout:'+timeout));\n            }, timeout);\n        }\n\n        try {\n            xhr.open('POST', request.getUrl(), true);\n            if (request.isWithCredentials()) {\n                xhr.withCredentials = true;\n            }\n\n            request.getHeaders().forEach((header) => xhr.setRequestHeader(header.name, header.value));\n\n            const formData = new FormData;\n\n            request.getParams().toArray().forEach((param) => formData.append(param.name, param.value));\n\n            formData.append(request.getName(), request.getBlob(), request.getBlobName());\n\n            xhr.send(formData);\n        } catch (e) {\n            abort();\n            i.reject(new AbortError(e.message));\n        }\n\n        const ret = i.promise();\n        ret.abort = abort;\n\n        return ret;\n    }\n}\n\nmodule.exports = Html5Transport;\n\n\n// WEBPACK FOOTER //\n// ./src/html5/transport.js","const Emitter = require('./emitter');\nconst Events = require('./events');\nconst {Deferred} = require('./util');\nconst {Status, StatusName} = require('./status');\n\nlet uid = 0;\nfunction guid() {\n    return 'FILE-' + (uid++).toString(16).toUpperCase();\n}\n\nconst RE_EXT = /\\.([^.]+)$/, RE_IMAGE = /^image\\/(jpg|jpeg|png|gif|bmp|webp)$/i;\nfunction guessExt(blob) {\n    let m = blob.name && RE_EXT.exec(blob.name);\n    if (m) {\n        return m[1];\n    }\n    m = blob.type && RE_IMAGE.exec(blob.type);\n    if (m) {\n        return m[1];\n    }\n    return '';\n}\n\nfunction guessType(ext) {\n    if (['jpg','jpeg','png','gif','bmp','webp'].indexOf(ext.toLowerCase()) > -1) {\n        return 'image/' + (ext === 'jpg' ? 'jpeg' : ext);\n    }\n    return null;\n}\n\nclass Progress {\n    constructor(total, loaded) {\n        this.change(total, loaded);\n    }\n\n    change(total, loaded) {\n        this.total = total;\n        this.loaded = loaded || 0;\n        this.percentage = this.loaded === this.total ? 100 : Math.ceil(this.loaded / this.total * 100)\n    }\n\n    done() {\n        this.change(this.total, this.total);\n    }\n}\n\nclass File extends Emitter {\n    constructor(runtime, source, filename) {\n        super();\n\n        this.id = guid();\n\n        this.name = source.name || filename || this.id;\n\n        var ext = guessExt(source).toLowerCase();\n\n        if (ext && !RE_EXT.test(this.name)) {\n            this.name += '.' + ext;\n        }\n\n        this.ext = ext;\n\n        this.type = source.type || guessType(this.ext) || 'application/octet-stream';\n\n        this.lastModified = source.lastModified || (+new Date);\n\n        this.size = source.size || 0;\n\n        this.runtime = runtime;\n\n        this.source = source;\n\n        this.status = Status.INITED;\n\n        this.progress = new Progress(this.size, 0);\n    }\n\n    getCore() {\n        return this.core;\n    }\n\n    setCore(core) {\n        this.core = core;\n        this.setPropagationTarget(core);\n    }\n\n    getRuntime() {\n        return this.runtime;\n    }\n\n    isImage() {\n        return RE_IMAGE.test(this.type);\n    }\n\n    setStatus(status, silent) {\n        let prevStatus = this.status;\n\n        if (prevStatus !== Status.CANCELLED && status !== prevStatus) {\n            this.status = status;\n            !silent && this.emit(Events.FILE_STATUS_CHANGE, status, prevStatus);\n        }\n    }\n\n    getStatus() {\n        return this.status;\n    }\n\n    getStatusName() {\n        if (this.status in StatusName) {\n            return StatusName[this.status];\n        } else {\n            return 'unknow';\n        }\n    }\n\n    getSource() {\n        return this.source;\n    }\n\n    getAsDataUrl(timeout) {\n        if (!this._dataUrlPromise) {\n            this._dataUrlPromise = this.runtime.getAsDataUrl(this.source, timeout);\n        }\n        return this._dataUrlPromise;\n    }\n\n    md5() {\n        if (!this._md5Promise) {\n            this._md5Promise = this.runtime.md5(this.source);\n        }\n        return this._md5Promise;\n    }\n\n    session() {\n        if (this._sessionPromise) {\n            return this._sessionPromise;\n        }\n\n        let ret = Deferred();\n\n        ret.progress((progress) => {\n            this.setStatus(Status.PROGRESS);\n            this.emit(Events.FILE_UPLOAD_PROGRESS, progress);\n        }).done((response) => {\n            this.response = response;\n            this._session = null;\n            this._sessionPromise = null;\n            this._flows = [];\n            this.setStatus(Status.SUCCESS);\n            this.emit(Events.FILE_UPLOAD_SUCCESS, response);\n        }).fail((error) => {\n            this._session = null;\n            this._sessionPromise = null;\n            let flow;\n            while (flow = this._flows.shift()) {\n                flow.abort();\n            }\n\n            if (error instanceof Error) {\n                this.setStatus(Status.ERROR);\n                this.emit(Events.FILE_UPLOAD_ERROR, error);\n            }\n        }).always(() => {\n            this.emit(Events.FILE_UPLOAD_COMPLETED, this.getStatus());\n        });\n\n        this._flows = [];\n        this._session = ret;\n        this._sessionPromise = ret.promise();\n\n        return this._sessionPromise;\n    }\n\n    prepare() {\n        if (this.status !== Status.PENDING || !this.core) {\n            return false;\n        }\n\n        this.session();\n        this.setStatus(Status.PROGRESS);\n\n        this.emit(Events.FILE_UPLOAD_START);\n\n        this.request = this.core.createFileRequest(this);\n\n        let ret = this.core.invoke(Events.FILE_UPLOAD_PREPARING, this.request);\n\n        this._flows.push(ret);\n\n        ret.then((request) => {\n            this.emit(Events.FILE_UPLOAD_PREPARED, request);\n\n            const upload = this.runtime.getUploading().generate(request);\n\n            this._flows.push(upload);\n\n            upload.progress((e) => {\n                this.progress.change(e.total, e.loaded);\n                this._session.notify(this.progress);\n            });\n\n            return upload;\n        }).then((response) => this.complete(response), this._session.reject);\n\n        return true;\n    }\n\n    complete(response) {\n        if (this.status !== Status.PROGRESS) return;\n\n        let flow;\n        while (flow = this._flows.shift()) {\n            flow.abort();\n        }\n\n        this.progress.done();\n        this._session.notify(this.progress);\n\n        response = this.request.createFileResponse(response);\n\n        this.setStatus(Status.END);\n        this.emit(Events.FILE_UPLOAD_END);\n\n        let ret = this.core.invoke(Events.FILE_UPLOAD_COMPLETING, response);\n\n        this._flows.push(ret);\n\n        ret.then(this._session.resolve, this._session.reject);\n    }\n\n    pending() {\n        if (this.status === Status.ERROR || this.status === Status.QUEUED) {\n            this.progress.change(this.size, 0);\n            this.setStatus(Status.PENDING);\n        }\n    }\n\n    abort() {\n        this._session && this._session.reject();\n        this._session = null;\n        this._sessionPromise = null;\n    }\n\n    cancel(silent) {\n        this.setStatus(Status.CANCELLED, silent);\n        !silent && this.emit(Events.FILE_CANCEL);\n        this.abort();\n        this.runtime.cancel(this.source);\n        this._dataUrlPromise && this._dataUrlPromise.abort();\n        this._md5Promise && this._md5Promise.abort && this._md5Promise.abort();\n        this.removeAllListeners();\n    }\n\n    destroy() {\n        this.cancel();\n    }\n}\n\nmodule.exports = File;\n\n\n// WEBPACK FOOTER //\n// ./src/file.js","const Emitter = require('../emitter');\nconst Runtime = require('../html5/runtime');\nconst File = require('../file');\n\nclass PasteCollector {\n    constructor(core) {\n        this.core = core;\n        this.runtime = Runtime.getInstance();\n    }\n\n    addArea(area) {\n        const core = this.core,\n            runtime = this.runtime,\n            emitter = new Emitter;\n\n        const paste = (e) => {\n\n            const clipboardData = e.clipboardData || window.clipboardData,\n                items = clipboardData.items,\n                files = clipboardData.files;\n\n            if (!files && !items) {\n                return;\n            }\n\n            let prevent, i, l, file, item, addRet;\n\n            if (files && files.length) {\n                // safari has files\n                prevent = files.length > 0;\n                for (i = 0, l = files.length; i < l; i++) {\n                    file = new File(runtime, files[i]);\n\n                    prevent = 1;\n\n                    addRet = core.add(file);\n                    if (addRet < 0 || (addRet > 0 && !core.isMultiple())) {\n                        break;\n                    }\n                }\n            } else if (items && items.length) {\n                // chrome has items\n                let filename = clipboardData.getData('text/plain');\n                for (i = 0, l = items.length; i < l && !core.isLimit(); i++) {\n                    item = items[i];\n\n                    if (item.kind !== 'file' || !(file = item.getAsFile())) {\n                        continue;\n                    }\n\n                    file = new File(runtime, file, filename);\n                    filename = null;\n\n                    prevent = 1;\n\n                    addRet = core.add(file);\n                    if (addRet < 0 || (addRet > 0 && !core.isMultiple())) {\n                        break;\n                    }\n                }\n            }\n\n            if (prevent) {\n                e.preventDefault();\n                e.stopPropagation();\n                emitter.emit('paste', clipboardData);\n            }\n        };\n\n        if (('DataTransfer' in window) && ('FileList' in window) && area.addEventListener) {\n            area.addEventListener('paste', paste, false);\n        }\n\n        emitter.destroy = () => {\n            emitter.removeAllListeners();\n            if (area.removeEventListener) {\n                area.removeEventListener('paste', paste, false);\n            }\n        };\n\n        return emitter;\n    }\n}\n\nmodule.exports = PasteCollector;\n\n\n// WEBPACK FOOTER //\n// ./src/collector/paste.js","const Emitter = require('../emitter');\nconst Html5Runtime = require('../html5/runtime');\nconst File = require('../file');\nconst { extend } = require('../util');\n\nconst createElement = (() => {\n    if (typeof document !== 'object') {\n        return;\n    }\n\n    var div = document.createElement('div');\n    return function (html) {\n        div.innerHTML = html;\n        html = div.firstChild;\n        div.removeChild(html);\n        return html;\n    };\n})();\n\nclass Html5TriggerCollection {\n    constructor(core, onFiles) {\n        const runtime = Html5Runtime.getInstance();\n        this.core = core;\n        this.onFiles = (files) => {\n            onFiles(files, runtime);\n        };\n        this.onChange = (e) => {\n            this.onFiles(e.target.files);\n            this.destroyInput();\n            this.createInput();\n        };\n        this.createInput();\n    }\n\n    destroyInput() {\n        if (!this.input) return;\n        this.input.removeEventListener('change', this.onChange, false);\n        document.body.removeChild(this.input);\n        this.input = null;\n    }\n\n    createInput() {\n        const input = createElement('<input type=\"file\" style=\"position:absolute;clip:rect(1px 1px 1px 1px);\" />');\n\n        let accept = this.core.getAccept();\n        if (accept && accept.length > 0) {\n            accept = accept.map((item) => {\n                return item.mimeTypes || ('.' + item.extensions.join(',.'));\n            });\n\n            input.setAttribute('accept', accept.join(','));\n        }\n        if (this.core.isMultiple()) {\n            input.setAttribute('multiple', 'multiple');\n        }\n\n        input.addEventListener('change', this.onChange, false);\n        document.body.appendChild(input);\n        this.input = input;\n    }\n\n    add(trigger) {\n        const fn = () => {\n            this.input.click();\n        };\n        trigger.addEventListener('click', fn);\n\n        return {\n            destroy() {\n                trigger.removeEventListener('click', fn);\n            },\n        };\n    }\n}\n\nclass PickerCollector {\n    static setSWF(url) {\n        // empty\n    }\n    constructor(core) {\n        const onFiles = (files, runtime) => {\n            for (let i = 0, l = files.length; i < l; i++) {\n                if (core.add(new File(runtime, files[i])) < 0) {\n                    break;\n                }\n            }\n        };\n\n        this.triggerCollection = new Html5TriggerCollection(core, onFiles);\n    }\n\n    addArea(area) {\n        return this.triggerCollection.add(area);\n    }\n}\n\nmodule.exports = PickerCollector;\n\n\n// WEBPACK FOOTER //\n// ./src/collector/picker.js"],"sourceRoot":""}